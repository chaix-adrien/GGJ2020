<!DOCTYPE html>
<html>
	<head>
		<script src="https://cdn.jsdelivr.net/npm/phaser@3.15.1/dist/phaser-arcade-physics.min.js"></script>
	</head>
	<body>
		<script>
			var config = {
				type: Phaser.AUTO,
				width: 800,
				height: 600,
				physics: {
					default: "arcade",
				},
				scene: {
					preload: preload,
					create: create,
					update: update,
				},
			}

			var game = new Phaser.Game(config)

			function preload() {
				this.load.setBaseURL("http://labs.phaser.io")

				this.load.image("sky", "assets/skies/space3.png")
				this.load.image("logo", "assets/sprites/phaser3-logo.png")
				this.load.image("red", "assets/particles/red.png")
			}

			function create() {
				var img = this.add.image(400, 300, "sky")

				var particles = this.add.particles("red")

				var emitter = particles.createEmitter({
					speed: 100,
					scale: { start: 1, end: 0 },
					blendMode: "ADD",
				})
				const rect = new Phaser.Geom.Rectangle()
				rect.setSize(400, 400)
				this.logo = this.physics.add.image(400, 100, "logo")
				this.input.on("pointermove", pointer => {
					const {
						position: { x, y },
					} = pointer
					console.log(rect)
					Phaser.Geom.Rectangle.CenterOn(rect, x, y)
					console.log(rect.contains(this.logo.x, this.logo.y))
					if (pointer.isDown && rect.contains(this.logo)) {
						this.physics.moveToObject(this.logo, pointer, 500)
					} else {
						this.logo.setVelocity(0, 0)
					}
				})

				this.input.on("pointerstilldown", pointer => {
					this.add.image(pointer.x, pointer.y, "logo")
				})
				emitter.startFollow(this.logo)
			}
			function update() {}
		</script>
	</body>
</html>
